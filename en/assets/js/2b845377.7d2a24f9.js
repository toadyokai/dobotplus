"use strict";(self.webpackChunk_dobot_plus_doc=self.webpackChunk_dobot_plus_doc||[]).push([[7129],{66078:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"lua/lock","title":"Distributed Lock","description":"Description","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/lua/13-lock.md","sourceDirName":"lua","slug":"/lua/lock","permalink":"/dobotplus/en/lua/lock","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":13,"frontMatter":{},"sidebar":"lua","previous":{"title":"Tray","permalink":"/dobotplus/en/lua/tray"}}');var s=i(65723),r=i(78573);const o={},a="Distributed Lock",l={},d=[{value:"Description",id:"description",level:2},{value:"Example to Illustrate the Role of Timeout Locks:",id:"example-to-illustrate-the-role-of-timeout-locks",level:3},{value:"Interfaces",id:"interfaces",level:2}];function c(e){const t={h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"distributed-lock",children:"Distributed Lock"})}),"\n",(0,s.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,s.jsx)(t.p,{children:"The introduction of the distributed lock module mainly aims to solve the data conflicts caused by multiple modules using the same resources."}),"\n",(0,s.jsx)(t.p,{children:"A typical application scenario is when a gripper and a camera simultaneously use the terminal's 485 communication. Both parties' plugins and user scripts need to communicate with the terminal's 485, but the 485 module cannot determine which party exclusively owns the communication at any given time. Therefore, an additional tool is needed to manage the exclusive relationship between resources."}),"\n",(0,s.jsx)(t.h3,{id:"example-to-illustrate-the-role-of-timeout-locks",children:"Example to Illustrate the Role of Timeout Locks:"}),"\n",(0,s.jsx)(t.p,{children:"Assume there is a printer that can immediately print received print requests. Suppose there are three users, A, B, and C, who have print requests. Their print tasks are A1, A2, A3... A10, B1, B2...B10, C1...C10, respectively. If there is no communication among them and they print when they need to, the output might be mixed, such as A1, B1, A2, C1, etc. In this case, the printed content does not meet any user's requirements, leading to complex logic for users to organize their data. Sometimes, they may even end up with incorrect data."}),"\n",(0,s.jsx)(t.p,{children:"To resolve this issue, a new \u201cadministrator\u201d is introduced, responsible for managing the use of the \u201cprinter.\u201d Assume that A is the first to recognize their printing needs and promptly reports them to the administrator. At this point, the administrator records that the \u201cprinter\u201d is exclusively owned by A for 2 minutes, allowing A to print their required content during this time. B and C will try to report their needs to the administrator during this period, but the administrator will ask B and C to wait. The administrator will only inform B and C when A's 2 minutes are up or when A finishes early."}),"\n",(0,s.jsx)(t.p,{children:"The overall timeline diagram is as follows:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:i(468).A+"",width:"984",height:"509"})}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"At this moment, the resource \u201cprinter\u201d is idle. User A tries to apply for usage rights and is immediately approved. After approval, A provides an estimated usage time (the maximum designed time is currently 10 seconds)."}),"\n",(0,s.jsx)(t.li,{children:"The resource \u201cprinter\u201d begins to be used."}),"\n",(0,s.jsx)(t.li,{children:"B applies to use the resource, but the administrator knows that the resource is still with A, so B's application is denied. B is asked to wait."}),"\n",(0,s.jsx)(t.li,{children:"B applies again and is denied again."}),"\n",(0,s.jsx)(t.li,{children:"C starts applying for the resource \u201cprinter,\u201d but the administrator denies C's request."}),"\n",(0,s.jsx)(t.li,{children:"A actively informs the administrator that the use of the resource \u201cprinter\u201d has ended."}),"\n",(0,s.jsx)(t.li,{children:"After A's usage ends, B applies for the resource \u201cprinter,\u201d and the administrator informs B that they can use it."}),"\n",(0,s.jsx)(t.li,{children:"After B has finished using the printer, C applies for the resource and obtains the usage rights through the administrator."}),"\n",(0,s.jsx)(t.li,{children:"C begins using the resource."}),"\n",(0,s.jsx)(t.li,{children:"C finds that the initial usage time reported to the administrator is insufficient and requests more time while the resource is still in use. The administrator agrees to extend C\u2019s usage."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"interfaces",children:"Interfaces"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Lock(name, TimeOut, WaitTime)"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Function:"})," Apply to lock the resource; only requests can be made."]}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.strong,{children:"Parameter Description:"})}),"\n"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Parameter"}),(0,s.jsx)(t.th,{children:"Range"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"name"}),(0,s.jsx)(t.td,{children:"A string without spaces"}),(0,s.jsx)(t.td,{children:"No length limit has been set, but it is recommended to not exceed 128 bytes."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"TimeOut"}),(0,s.jsx)(t.td,{children:"[10,10000]"}),(0,s.jsx)(t.td,{children:"The time to exclusively occupy the resource, in milliseconds."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"WaitTime"}),(0,s.jsx)(t.td,{children:"[0,0x7FFFFFFF]"}),(0,s.jsx)(t.td,{children:"Optional parameter, the timeout for waiting. 0 means no waiting and returns immediately; greater than 0 means the maximum waiting time. Internally uses u32 type."})]})]})]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.strong,{children:"Return Value Description:"})}),"\n"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Return Value"}),(0,s.jsx)(t.th,{children:"Range"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"err"}),(0,s.jsx)(t.td,{children:"true/false"}),(0,s.jsx)(t.td,{children:"Whether it was successful; true means success, false means failure."})]})})]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"UnLock(name)"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Function:"})," Actively release the resource."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Parameter Description:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"name:"})," The name of the resource to be released, of string type, with the same range, content, and recommendations as TimeOutLock."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.strong,{children:"Return Value Description:"})}),"\n"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Return Value"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"err"}),(0,s.jsx)(t.td,{children:"Indicates whether there was an error; true means no error, false means there was an error."})]})})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},468:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/lock-2cacc8485fb9bac15ceed9156baf15ad.svg"},78573:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var n=i(22155);const s={},r=n.createContext(s);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);