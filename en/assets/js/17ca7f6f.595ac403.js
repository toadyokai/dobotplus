"use strict";(self.webpackChunk_dobot_plus_website=self.webpackChunk_dobot_plus_website||[]).push([[3700],{45902:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>a});var o=t(65723),l=t(43327);const i={},r="TCP/IP Control of External Devices",s={id:"tutorials/Examples/tcpip",title:"TCP/IP Control of External Devices",description:"Please refer to the IO Control Case for the process of creating a plugin. After creating the plugin, please follow the order of userAPI.lua, httpAPI.lua, daemon.lua, and ui/pages/Main.tsx to complete the development of the plugin's business logic.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/tutorials/Examples/03-tcpip.md",sourceDirName:"tutorials/Examples",slug:"/tutorials/Examples/tcpip",permalink:"/dobotplus/en/tutorials/Examples/tcpip",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorials",previous:{title:"Using Keyboard Shortcuts to Control Device IO",permalink:"/dobotplus/en/tutorials/Examples/hotkey"},next:{title:"Control the End Effector Gripper",permalink:"/dobotplus/en/tutorials/Examples/grip"}},c={},a=[{value:"Example Workflow",id:"example-workflow",level:2},{value:"control.lua Module",id:"controllua-module",level:2},{value:"httpAPI.lua Module",id:"httpapilua-module",level:2},{value:"ui/Main.tsx Module",id:"uimaintsx-module",level:2},{value:"Running and Debugging",id:"running-and-debugging",level:2},{value:"Building the Plugin",id:"building-the-plugin",level:2}];function u(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"tcpip-control-of-external-devices",children:"TCP/IP Control of External Devices"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Please refer to the ",(0,o.jsx)(n.a,{href:"/dobotplus/en/tutorials/Examples/io",children:"IO Control Case"})," for the process of creating a plugin. After creating the plugin, please follow the order of ",(0,o.jsx)(n.code,{children:"userAPI.lua"}),", ",(0,o.jsx)(n.code,{children:"httpAPI.lua"}),", ",(0,o.jsx)(n.code,{children:"daemon.lua"}),", and ",(0,o.jsx)(n.code,{children:"ui/pages/Main.tsx"})," to complete the development of the plugin's business logic."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"example-workflow",children:"Example Workflow"}),"\n",(0,o.jsx)(n.mermaid,{value:"graph LR\nA[Move Up Button]--\x3e|Click|B(Send Grip HTTP Request)--\x3e|Controller Invokes|C[httpApi Module Method]--\x3e|Parameter Processing, Reference|D[control.lua Module]\nA1[Move Down Button]--\x3e|Click|B1(Send Grip HTTP Request)--\x3e|Controller Invokes|C[httpApi Module Method]\nD --\x3e|TCP/IP|E[End Effector]"}),"\n",(0,o.jsx)(n.h2,{id:"controllua-module",children:"control.lua Module"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-lua",children:'local control = {}\n\n---@param position string\n---@param socket number\nfunction control.moveTo(position, socket)\n    TCPWrite(socket, "moveTo_absolutePosition"..","..position.."\\n")\n    TCPRead(socket, 3 , \'string\')\nend\n\nreturn control\n'})}),"\n",(0,o.jsx)(n.h2,{id:"httpapilua-module",children:"httpAPI.lua Module"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-lua",children:"local httpModule = {}\nlocal control = require('control')\n\nlocal socket = nil\n\n---Move the lift column\nhttpModule.moveTo = function(params)\n  if socket then\n    control.moveTo(params.position, socket)\n  end\n  return {\n    status = true\n  }\nend\n\n---Initialize TCP connection\nhttpModule.init = function(params)\n  local result = CreateTCPConnection(params.ip, params.port, 10000)\n  if result.socket then\n    socket = result.socket\n  end\n  return {\n    status = true\n  }\nend\n\nreturn httpModule\n"})}),"\n",(0,o.jsx)(n.h2,{id:"uimaintsx-module",children:"ui/Main.tsx Module"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:"import { Button } from '@dobot-plus/components'\nimport { useEffect, useState } from 'react'\nimport { http, DobotPlusApp } from '@dobot/index'\n\nfunction App() {\n  const [position, setPosition] = useState(0)\n\n  function handleButton1Click() { http.moveTo({ position: position + 50 }) }\n\n  function handleButton2Click() { http.moveTo({ position: position - 50 }) }\n\n  useEffect(() => {\n    http.init({\n      ip: '192.168.5.1', // Default IP, update here when actual IP changes\n      port: '123'        // Enter the actual correct port number here\n    })\n  }, [])\n\n  return (\n    <div className=\"app\">\n      <DobotPlusApp>\n        <Button type=\"primary\" onClick={handleButton1Click}>Move up</Button>\n        <Button type=\"primary\" onClick={handleButton2Click}>Move down</Button>\n      </DobotPlusApp>\n    </div>\n  )\n}\n\nexport default App\n"})}),"\n",(0,o.jsx)(n.h2,{id:"running-and-debugging",children:"Running and Debugging"}),"\n",(0,o.jsx)(n.p,{children:"The debugging command for the plugin can perform the following two types of development work:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Debug only the page"}),"\n",(0,o.jsx)(n.li,{children:"Connect to a real device for debugging"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"dpt dev\n"})}),"\n",(0,o.jsx)(n.p,{children:"When executing the above command, the command line will prompt developers whether to connect a real device for testing."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ dpt dev\n? Debug lua on real device? Yes\n? Please check the device IP: 192.168.5.1 (y/n)\n"})}),"\n",(0,o.jsx)(n.p,{children:"Developers need to confirm:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Whether the actual IP of the controller is correct; the default is ",(0,o.jsx)(n.code,{children:"192.168.5.1"})]}),"\n",(0,o.jsx)(n.li,{children:"Whether the SFTP service-related configuration is correct"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["For detailed information on the above configurations, please refer to the ",(0,o.jsx)(n.code,{children:"dpt.json"})," configuration file."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "ip": "192.168.5.1",                              // Controller IP\n  "pluginPort": 22100\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"building-the-plugin",children:"Building the Plugin"}),"\n",(0,o.jsx)(n.p,{children:"After completing the development, debugging, and optimization of the plugin, you can execute the final build work by running:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"dpt build\n"})}),"\n",(0,o.jsxs)(n.p,{children:["After the program executes successfully, there will be a ",(0,o.jsx)(n.code,{children:"dist"})," folder and an ",(0,o.jsx)(n.code,{children:"output"})," folder in the current directory."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.code,{children:"dist"})," folder contains the plugin code after this build, allowing developers to check the build results."]}),"\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.code,{children:"output"})," folder contains a compressed ",(0,o.jsx)(n.code,{children:"zip"})," file named in the format ",(0,o.jsx)(n.code,{children:"<plugin_name>-<version_number>.zip"}),", which is the plugin to be imported for actual use on the client."]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},43327:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>s});var o=t(22155);const l={},i=o.createContext(l);function r(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);