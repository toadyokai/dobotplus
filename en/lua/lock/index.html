<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-lua/lock" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Distributed Lock | Dobot+ Plugins Toolkit</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://toadyokai.github.io/dobotplus/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://toadyokai.github.io/dobotplus/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://toadyokai.github.io/dobotplus/en/lua/lock"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Distributed Lock | Dobot+ Plugins Toolkit"><meta data-rh="true" name="description" content="Description"><meta data-rh="true" property="og:description" content="Description"><link data-rh="true" rel="icon" href="/dobotplus/en/img/favicon.png"><link data-rh="true" rel="canonical" href="https://toadyokai.github.io/dobotplus/en/lua/lock"><link data-rh="true" rel="alternate" href="https://toadyokai.github.io/dobotplus/lua/lock" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://toadyokai.github.io/dobotplus/en/lua/lock" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://toadyokai.github.io/dobotplus/lua/lock" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4SOWVHXZB0-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Dobot+ Plugins Toolkit" href="/dobotplus/en/opensearch.xml"><link rel="stylesheet" href="/dobotplus/en/assets/css/styles.281ebb26.css">
<script src="/dobotplus/en/assets/js/runtime~main.88793aac.js" defer="defer"></script>
<script src="/dobotplus/en/assets/js/main.f2453260.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_iRcU" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dobotplus/en/"><div class="navbar__logo"><img src="/dobotplus/en/img/logo.svg" alt="My Site Logo" class="themedComponent_SpSG themedComponent--light_tOzR"><img src="/dobotplus/en/img/logo-dark.svg" alt="My Site Logo" class="themedComponent_SpSG themedComponent--dark_Bm5o"></div></a><a class="navbar__item navbar__link" href="/dobotplus/en/tutorials/environment">tutorials/environment</a><a class="navbar__item navbar__link" href="/dobotplus/en/api/install">api/install</a><a class="navbar__item navbar__link" href="/dobotplus/en/components/Alert">components/Alert</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dobotplus/en/lua/grammer">lua/grammer</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_gjig"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/dobotplus/lua/lock" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li><li><a href="/dobotplus/en/lua/lock" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-US">English</a></li></ul></div><div class="toggle_YRJY colorModeToggle_eVrP"><button class="clean-btn toggleButton_gKlr toggleButtonDisabled_ksps" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_vPDS"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nErn"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_qXhv"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_CmD6"><div class="docsWrapper_s1AF"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_oz7Z" type="button"></button><div class="docRoot_HJE2"><aside class="theme-doc-sidebar-container docSidebarContainer_SbzE"><div class="sidebarViewport_bJlG"><div class="sidebar_r4cm"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_dBSr"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/grammer">Basic Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/operator">Operators in Lua</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/flow">Control Flow in Lua</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/modbus">Modbus Protocol Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/tcp">TCP and UDP Communication Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/tool">End Effector Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/io">IO Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/motion">Motion Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/safeskin">Safe Skin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/busRegister">Bus Register</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/programControl">Program Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dobotplus/en/lua/tray">Tray</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/dobotplus/en/lua/lock">Distributed Lock</a></li></ul></nav></div></div></aside><main class="docMainContainer_sDcP"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_WD4m"><div class="docItemContainer_qdCC"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_u5Gf" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/dobotplus/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_bVfp"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Distributed Lock</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_jGeb theme-doc-toc-mobile tocMobile_D2Mz"><button type="button" class="clean-btn tocCollapsibleButton_cFos">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Distributed Lock</h1></header>
<h2 class="anchor anchorWithStickyNavbar_PJTr" id="description">Description<a href="#description" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h2>
<p>The introduction of the distributed lock module mainly aims to solve the data conflicts caused by multiple modules using the same resources.</p>
<p>A typical application scenario is when a gripper and a camera simultaneously use the terminal&#x27;s 485 communication. Both parties&#x27; plugins and user scripts need to communicate with the terminal&#x27;s 485, but the 485 module cannot determine which party exclusively owns the communication at any given time. Therefore, an additional tool is needed to manage the exclusive relationship between resources.</p>
<h3 class="anchor anchorWithStickyNavbar_PJTr" id="example-to-illustrate-the-role-of-timeout-locks">Example to Illustrate the Role of Timeout Locks:<a href="#example-to-illustrate-the-role-of-timeout-locks" class="hash-link" aria-label="Direct link to Example to Illustrate the Role of Timeout Locks:" title="Direct link to Example to Illustrate the Role of Timeout Locks:">​</a></h3>
<p>Assume there is a printer that can immediately print received print requests. Suppose there are three users, A, B, and C, who have print requests. Their print tasks are A1, A2, A3... A10, B1, B2...B10, C1...C10, respectively. If there is no communication among them and they print when they need to, the output might be mixed, such as A1, B1, A2, C1, etc. In this case, the printed content does not meet any user&#x27;s requirements, leading to complex logic for users to organize their data. Sometimes, they may even end up with incorrect data.</p>
<p>To resolve this issue, a new “administrator” is introduced, responsible for managing the use of the “printer.” Assume that A is the first to recognize their printing needs and promptly reports them to the administrator. At this point, the administrator records that the “printer” is exclusively owned by A for 2 minutes, allowing A to print their required content during this time. B and C will try to report their needs to the administrator during this period, but the administrator will ask B and C to wait. The administrator will only inform B and C when A&#x27;s 2 minutes are up or when A finishes early.</p>
<p>The overall timeline diagram is as follows:</p>
<p><img decoding="async" loading="lazy" src="/dobotplus/en/assets/images/lock-2cacc8485fb9bac15ceed9156baf15ad.svg" width="984" height="509" class="img_ItB7"></p>
<ol>
<li>At this moment, the resource “printer” is idle. User A tries to apply for usage rights and is immediately approved. After approval, A provides an estimated usage time (the maximum designed time is currently 10 seconds).</li>
<li>The resource “printer” begins to be used.</li>
<li>B applies to use the resource, but the administrator knows that the resource is still with A, so B&#x27;s application is denied. B is asked to wait.</li>
<li>B applies again and is denied again.</li>
<li>C starts applying for the resource “printer,” but the administrator denies C&#x27;s request.</li>
<li>A actively informs the administrator that the use of the resource “printer” has ended.</li>
<li>After A&#x27;s usage ends, B applies for the resource “printer,” and the administrator informs B that they can use it.</li>
<li>After B has finished using the printer, C applies for the resource and obtains the usage rights through the administrator.</li>
<li>C begins using the resource.</li>
<li>C finds that the initial usage time reported to the administrator is insufficient and requests more time while the resource is still in use. The administrator agrees to extend C’s usage.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_PJTr" id="interfaces">Interfaces<a href="#interfaces" class="hash-link" aria-label="Direct link to Interfaces" title="Direct link to Interfaces">​</a></h2>
<p><strong>Lock(name, TimeOut, WaitTime)</strong></p>
<ul>
<li><strong>Function:</strong> Apply to lock the resource; only requests can be made.</li>
<li><strong>Parameter Description:</strong></li>
</ul>
<table><thead><tr><th>Parameter</th><th>Range</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>A string without spaces</td><td>No length limit has been set, but it is recommended to not exceed 128 bytes.</td></tr><tr><td>TimeOut</td><td>[10,10000]</td><td>The time to exclusively occupy the resource, in milliseconds.</td></tr><tr><td>WaitTime</td><td>[0,0x7FFFFFFF]</td><td>Optional parameter, the timeout for waiting. 0 means no waiting and returns immediately; greater than 0 means the maximum waiting time. Internally uses u32 type.</td></tr></tbody></table>
<ul>
<li><strong>Return Value Description:</strong></li>
</ul>
<table><thead><tr><th>Return Value</th><th>Range</th><th>Description</th></tr></thead><tbody><tr><td>err</td><td>true/false</td><td>Whether it was successful; true means success, false means failure.</td></tr></tbody></table>
<p><strong>UnLock(name)</strong></p>
<ul>
<li><strong>Function:</strong> Actively release the resource.</li>
<li><strong>Parameter Description:</strong>
<ul>
<li><strong>name:</strong> The name of the resource to be released, of string type, with the same range, content, and recommendations as TimeOutLock.</li>
</ul>
</li>
<li><strong>Return Value Description:</strong></li>
</ul>
<table><thead><tr><th>Return Value</th><th>Description</th></tr></thead><tbody><tr><td>err</td><td>Indicates whether there was an error; true means no error, false means there was an error.</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/dobotplus/en/lua/tray"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tray</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Zkp4 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#description" class="table-of-contents__link toc-highlight">Description</a><ul><li><a href="#example-to-illustrate-the-role-of-timeout-locks" class="table-of-contents__link toc-highlight">Example to Illustrate the Role of Timeout Locks:</a></li></ul></li><li><a href="#interfaces" class="table-of-contents__link toc-highlight">Interfaces</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2023 Dobot All Rights Reserved. 粤ICP备16048417号-1</div></div></div></footer></div>
</body>
</html>